<!--
  FILE: src/app/features/seller/pages/seller-dashboard/seller-dashboard.component.html
  MÔ TẢ: Giao diện đã được chuyển đổi sang sử dụng NzTabs và NzTable của NG-ZORRO.
-->

<!-- 1. Page Header -->
<nz-page-header class="site-page-header" nzTitle="Quản lý Booking"></nz-page-header>

<!-- 2. Card chứa nội dung chính -->
<div class="p-6 bg-white rounded-lg shadow-md">
  <!-- Sử dụng nz-tabset để tạo các tab -->
  <nz-tabset [(nzSelectedIndex)]="selectedTabIndex" (nzSelectChange)="onTabChange()">
    <!-- Tab 1: Booking chờ xử lý -->
    <nz-tab nzTitle="Booking chờ xử lý">
      <ng-template nz-tab>
        <nz-table #availableTable [nzData]="availableBookings?.items || []" [nzLoading]="isLoadingAvailable"
          [nzTotal]="availableBookings?.total || 0" [(nzPageIndex)]="availableBookingsPage"
          [(nzPageSize)]="pageSize" (nzPageIndexChange)="loadAvailableBookings()"
          (nzPageSizeChange)="loadAvailableBookings(true)" nzShowSizeChanger [nzFrontPagination]="false" nzBordered>
          <thead>
            <tr>
              <th>Tên Tour</th>
              <th>Khách hàng</th>
              <th>Ngày đặt</th>
              <th>Ngày đi</th>
              <th>Số khách</th>
              <th nzAlign="center">Trạng thái</th>
              <th nzAlign="center">Hành động</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let booking of availableTable.data" (click)="navigateToDetail(booking.id)"
              class="cursor-pointer hover:bg-gray-50">
              <td>{{ booking.tourName }}</td>
              <td>{{ booking.customer }}</td>
              <td>{{ booking.bookingDate | formatDate }}</td>
              <td>{{ booking.departureDate | formatDate }}</td>
              <td>{{ booking.seats }}</td>
              <td nzAlign="center">
                <nz-tag [nzColor]="getStatusColor(booking.status)">{{ booking.status | statusVietnamese }}</nz-tag>
              </td>
              <td nzAlign="center">
                <button nz-button nzType="primary" nzSize="small" (click)="$event.stopPropagation()" nz-popconfirm
                  nzPopconfirmTitle="Bạn chắc chắn muốn nhận booking này?" (nzOnConfirm)="onClaimBooking(booking.id)">
                  Nhận
                </button>
              </td>
            </tr>
          </tbody>
        </nz-table>
      </ng-template>
    </nz-tab>

    <!-- Tab 2: Booking của tôi -->
    <nz-tab nzTitle="Booking của tôi">
      <ng-template nz-tab>
        <nz-table #editedTable [nzData]="editedBookings?.items || []" [nzLoading]="isLoadingEdited"
          [nzTotal]="editedBookings?.total || 0" [(nzPageIndex)]="editedBookingsPage" [(nzPageSize)]="pageSize"
          (nzPageIndexChange)="loadEditedBookings()" (nzPageSizeChange)="loadEditedBookings(true)" nzShowSizeChanger
          [nzFrontPagination]="false" nzBordered>
          <thead>
            <tr>
              <th>Tên Tour</th>
              <th>Khách hàng</th>
              <th>Ngày đặt</th>
              <th>Ngày đi</th>
              <th>Số khách</th>
              <th nzAlign="center">Trạng thái</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let booking of editedTable.data" (click)="navigateToDetail(booking.id)"
              class="cursor-pointer hover:bg-gray-50">
              <td>{{ booking.tourName }}</td>
              <td>{{ booking.customer }}</td>
              <td>{{ booking.bookingDate | formatDate }}</td>
              <td>{{ booking.departureDate | formatDate }}</td>
              <td>{{ booking.seats }}</td>
              <td nzAlign="center">
                <nz-tag [nzColor]="getStatusColor(booking.status)">{{ booking.status | statusVietnamese }}</nz-tag>
              </td>
            </tr>
          </tbody>
        </nz-table>
      </ng-template>
    </nz-tab>
  </nz-tabset>
</div>
