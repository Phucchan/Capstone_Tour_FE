<app-skeleton [isLoading]="isLoading" [showHeader]="true" [showImageSection]="true" [showPriceBox]="true"
  [showCalendar]="true" [showSchedule]="true" [showImportantInfo]="true" [showOtherTours]="true">
</app-skeleton>

<div *ngIf="!isLoading">
  <app-hero-section></app-hero-section>
  <!-- Search Bar -->
  <div class="flex flex-wrap justify-center items-center w-[900px] mx-auto gap-4 my-8 border-2 border-blue-300 p-4 rounded-3xl shadow-md bg-white">
    <h2 class="text-2xl font-bold text-blue-700">
      T√¨m Ki·∫øm ƒêi·ªÉm ƒê·∫øn
    </h2>

  <!-- Khung t√¨m ki·∫øm -->
  <div class="relative w-full border-none">
    <!-- Icon search -->
    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" stroke-width="2"
        viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z" />
      </svg>
    </div>

    <!-- NgSelect -->
    <ng-select
      [items]="destinationList"
      bindLabel="name"
     
      placeholder="T√¨m ƒëi·ªÉm ƒë·∫øn..."
      class="pl-10 pr-3 py-2"
      [ngClass]="'w-full rounded focus:outline-none focus:ring focus:border-blue-400'"
      (change)="goToLocation($event.id)">
    </ng-select>
  </div>
</div>

  <div *ngIf="errorMessage" class="text-center py-10 text-red-500">
    {{ errorMessage }}
  </div>
  <!-- navigation bar -->
  <section class="bg-white py-16 px-4 sm:px-6 lg:px-8">
    <div class="text-center max-w-4xl mx-auto mb-12">
      <h2 class="text-3xl sm:text-4xl font-bold text-blue-700 mb-4">
        Ch√∫ng t√¥i c√≥ th·ª© b·∫°n c·∫ßn
      </h2>
      <p class="text-gray-500 text-lg">
        ƒêi ƒê√¢u l√† n·ªÅn t·∫£ng du l·ªãch gi√∫p b·∫°n d·ªÖ d√†ng kh√°m ph√° m·ªçi v√πng ƒë·∫•t tuy·ªát ƒë·∫πp tr√™n kh·∫Øp Vi·ªát Nam.
        T·ª´ ƒë·∫∑t tour, t√¨m ƒëi·ªÉm ƒë·∫øn h·∫•p d·∫´n ƒë·∫øn tr·∫£i nghi·ªám vƒÉn h√≥a ƒë·ªãa ph∆∞∆°ng, t·∫•t c·∫£ ƒë·ªÅu c√≥ t·∫°i ƒë√¢y!
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
      <div class="relative rounded-lg overflow-hidden shadow-md group">
        <img src="assets/images/logo/Hoa-Phuong.jpg" alt="" loading="lazy"
          class="w-full aspect-[3/4] object-cover group-hover:scale-105 transition" />
        <div class="absolute top-4 left-4 bg-orange-400 text-white px-4 py-1 rounded-full text font-semibold">
          Thi·∫øt k·∫ø chuy·∫øn ƒëi c·ªßa ri√™ng b·∫°n
        </div>
        <div class="absolute bottom-20 left-0 right-0 text-center px-4">
          <div class="bg-white/70 px-3 py-2 text-gray-700 font-semibold rounded">
            C√πng nhau kh√°m ph√°<br />
            T√¨m ki·∫øm b·∫°n b√® - k·∫øt n·ªëi h√†nh tr√¨nh, tr·ªçn v·∫πn tr·∫£i nghi·ªám
          </div>
        </div>
        <div class="absolute bottom-4 left-0 right-0 text-center">
          <a routerLink="/plan-generation"
            class="bg-gradient-to-r from-orange-400 to-purple-500 text-white px-6 py-2 rounded-full font-semibold hover:opacity-90 transition">
            XEM TH√äM
          </a>
        </div>
      </div>

      <div class="relative rounded-lg overflow-hidden shadow-md group">
        <img src="assets/images/logo/ruongbacthang.jpg" alt="" loading="lazy"
          class="w-full aspect-[3/4] object-cover group-hover:scale-105 transition" />
        <div class="absolute top-4 left-4 bg-orange-400 text-white px-4 py-1 rounded-full text font-semibold">
          Ch√∫ng t√¥i c√≥ chuy·∫øn ƒëi b·∫°n t√¨m
        </div>
        <div class="absolute bottom-20 left-0 right-0 text-center px-4">
          <div class="bg-white/70 px-3 py-2 text-gray-700 font-semibold rounded">
            S·∫µn s√†ng cho m·ªçi chuy·∫øn ƒëi c·ªßa b·∫°n<br />
            Kh√°m ph√° ƒëi·ªÉm ƒë·∫øn - G·∫Øn k·∫øt c·∫£m x√∫c, l∆∞u gi·ªØ k·ª∑ ni·ªám
          </div>
        </div>
        <div class="absolute bottom-4 left-0 right-0 text-center">
          <a routerLink="/custom-order-tour"
            class="bg-gradient-to-r from-orange-400 to-purple-500 text-white px-6 py-2 rounded-full font-semibold hover:opacity-90 transition">
            XEM TH√äM
          </a>  
        </div>
      </div>

      <div class="relative rounded-lg overflow-hidden shadow-md group">
        <img src="assets/images/logo/tasua.webp" alt="" loading="lazy"
          class="w-full aspect-[3/4] object-cover group-hover:scale-105 transition" />
        <div class="absolute top-4 left-4 bg-orange-400 text-white px-4 py-1 rounded-full text font-semibold">
          L∆∞u d·∫•u h√†nh tr√¨nh
        </div>
        <div class="absolute bottom-20 left-0 right-0 text-center px-4">
          <div class="bg-white/70 px-3 py-2 text-gray-700 font-semibold rounded">
            ƒêi l√† c√≥ th∆∞·ªüng<br />
            L∆∞u d·∫•u h√†nh tr√¨nh. Qu√† t·∫∑ng h·∫øt √Ω
          </div>
        </div>
        <div class="absolute bottom-4 left-0 right-0 text-center">
          <a [routerLink]="['/customer/wishlist']"
            class="bg-gradient-to-r from-orange-400 to-purple-500 text-white px-6 py-2 rounded-full font-semibold hover:opacity-90 transition">
            XEM TH√äM
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Tours-discount Section -->
  <ng-container *ngIf="!isLoading && !errorMessage">
    <section class="bg-white py-16 px-4 sm:px-6 lg:px-8">
      <div class="max-w-7xl mx-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-center text-blue-700 mb-8 uppercase">Tour ∆Øu ƒê√£i</h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2">
          <div *ngFor="let tour of saleTours" (click)="goToTourDiscountBooking(tour.tourId, tour.scheduleId)"
            class="flex flex-col relative bg-white shadow-md rounded-lg overflow-hidden h-[500px] hover:shadow-lg transition cursor-pointer">

            <!-- G·∫Øn nh√£n gi·∫£m gi√° -->
            <div *ngIf="tour.discountPercent > 0"
              class="absolute left-2 top-2 bg-red-500 text-white px-2 py-1 rounded-full z-10 text-xs font-bold">
              Gi·∫£m {{ tour.discountPercent }}%
            </div>

            <!-- ·∫¢nh -->
            <img [src]="tour.thumbnailUrl" alt="Tour" loading="lazy"
              class="w-full h-[200px] object-cover transition-transform duration-300 hover:scale-105" />

            <!-- N·ªôi dung -->
            <div class="p-4 flex flex-col flex-1">
              <!-- T√™n tour -->
              <h3 class="text-base font-semibold text-gray-800 line-clamp-2 leading-snug mb-2 min-h-[3rem]">
                {{ tour.name }}
              </h3>

              <!-- Th√¥ng tin -->
              <div class="flex flex-col justify-between flex-1 space-y-2 text-sm text-black-600">
                <p>üÜî M√£ tour: {{ tour.code }}</p>
                <p>üìç Kh·ªüi h√†nh: {{ tour.locationName }}</p>
                <p>‚è≥ Th·ªùi gian: {{ tour.durationDays | durationFormat }}</p>
                <p class="text-yellow-600">‚≠ê ƒê√°nh gi√°: {{ tour.averageRating }}/5 ‚òÖ</p>

                <!-- Danh s√°ch ng√†y kh·ªüi h√†nh (scroll + n√∫t tr√°i/ph·∫£i) -->
                <div class="flex items-center gap-2 mt-2">
                  <span class="text-sm text-gray-700 flex-shrink-0">üìÖ</span>

                  <!-- N√∫t tr√°i -->
                  <button (click)="scrollLeft(tour.tourId); $event.stopPropagation()"
                    class="text-gray-500 hover:text-black text-xs px-1 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition">
                    ‚Üê
                  </button>

                  <!-- Scroll ngang -->
                  <div #scrollRef class="flex overflow-x-auto no-scrollbar gap-2 max-w-[250px]"
                    [attr.data-tour-id]="tour.tourId">
                    <button *ngFor="let d of tour.departureDates" (click)="$event.stopPropagation()"
                      class="border border-red-500 text-red-500 text-xs px-1 py-1 rounded-md hover:bg-red-50 whitespace-nowrap">
                      {{ d | date:'dd/MM' }}
                    </button>
                  </div>

                  <!-- N√∫t ph·∫£i -->
                  <button (click)="scrollRight(tour.tourId); $event.stopPropagation()"
                    class="text-gray-500 hover:text-black text-xs px-1 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition">
                    ‚Üí
                  </button>
                </div>

                <p class="text-sm text-black-600">
                  {{ tour.tourTransport | iconTransport }}
                </p>

                <!-- Gi√° -->
                <div class="mt-3">
                  <p class="font-semibold text-gray-800 text-[16px] leading-tight mb-0">Gi√° t·ª´:
                    <ng-container *ngIf="tour.discountPercent > 0; else noDiscount">
                      <span class="text-gray-400 font-semibold text-[16px] line-through ml-2 align-middle">
                        {{ tour.startingPrice | currencyVnd }}
                      </span>
                    </ng-container>
                  </p>
                  <ng-container *ngIf="tour.discountPercent > 0; else noDiscount">
                    <div>
                      <span class="text-red-500 font-extrabold text-[19px] leading-tight align-middle">
                        {{ getDiscountedPrice(tour) | currencyVnd }}
                      </span>
                    </div>
                  </ng-container>
                  <ng-template #noDiscount>
                    <span class="text-red-500 font-extrabold text-[19px] leading-tight align-middle">
                      {{ tour.startingPrice | currencyVnd }}
                    </span>
                  </ng-template>
                </div>


              </div>
            </div>
          </div>

        </div>
        <div class="mt-8 flex justify-center">
          <a routerLink="/discount-tours"
            class="inline-block border border-blue-600 text-blue-600 px-6 py-2 rounded-full font-semibold hover:bg-blue-600 hover:text-white transition">
            Xem t·∫•t c·∫£
          </a>
        </div>
      </div>
    </section>
  </ng-container>



  <!-- Featured Destinations Section -->
  <section class="bg-white py-16 px-4 sm:px-6 lg:px-8">
    <div class="text-center max-w-3xl mx-auto mb-10">
      <h2 class="text-3xl sm:text-4xl font-bold text-blue-700">ƒêI·ªÇM DU L·ªäCH H·∫§P D·∫™N</h2>
      <p class="text-gray-600 mt-4">
        "ƒêi ƒê√¢u" lu√¥n c√≥ nh·ªØng s·∫£n ph·∫©m ƒë·∫øn c√°c ƒëi·ªÉm du l·ªãch h·∫•p d·∫´n tr·∫£i d√†i kh·∫Øp m·∫£nh ƒë·∫•t h√¨nh ch·ªØ S.
      </p>
      <p class="mt-2 font-semibold text-blue-600">ƒêi·ªÉm ƒë·∫øn trong n∆∞·ªõc</p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
      <div *ngFor="let location of locations"
        class="bg-white rounded-lg shadow overflow-hidden hover:shadow-md transition cursor-pointer"
        (click)="goToLocation(location.id)">
        <img [src]="location.image || 'assets/images/default-location.jpg'" loading="lazy" alt="{{ location.name }}"
          class="w-full h-[180px] object-cover" />
        <div class="p-4 text-center">
          <h3 class="text-lg font-semibold text-gray-800">{{ location.name }}</h3>
        </div>
      </div>
    </div>
  </section>



  <!-- Recent Blogs Section -->
  <ng-container *ngIf="!isLoading && !errorMessage">
    <section class="bg-white py-16 px-4 sm:px-6 lg:px-8">
      <div class="max-w-7xl mx-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-center text-blue-700 mb-8 uppercase">B√†i vi·∫øt
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
          <div *ngFor="let blog of blogs"
            class="group bg-white rounded-lg shadow-sm overflow-hidden flex flex-col min-h-[350px]">
            <div class="relative w-full aspect-[3/4]">
              <img [src]="blog?.thumbnailImageUrl || 'assets/images/default-blog.jpg'" alt="thumbnail"
                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
                loading="lazy" />
            </div>
            <div class="p-4 flex flex-col">
              <p class="text-sm text-gray-500 mb-1">{{ blog?.authorName }}</p>
              <h3
                class="font-semibold text-base mb-2 text-gray-900 hover:text-blue-600 transition cursor-pointer line-clamp-2">
                {{ blog?.title }}
              </h3>
              <p class="text-sm text-gray-400 mt-auto">{{ getTime(blog.createdAt) }}</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </ng-container>
</div>