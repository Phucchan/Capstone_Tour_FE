<!-- Ghi chú: Sử dụng màu nền xám nhạt cho toàn bộ trang -->
<div class="bg-gray-50 min-h-screen">
  <!--
    Ghi chú: Thêm container để giới hạn chiều rộng và căn giữa nội dung.
    - `container`: Đặt max-width theo các breakpoint.
    - `mx-auto`: Căn giữa container theo chiều ngang.
    - `py-8 px-4`: Thêm padding dọc và ngang.
  -->
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Page Header -->
    <div class="flex flex-wrap justify-between items-center gap-4 mb-6">
      <div>
        <h1 class="text-2xl md:text-3xl font-bold text-gray-900">
          Quản lý Quyết toán Booking
        </h1>
        <p class="text-sm text-gray-600 mt-1">
          Xem và quản lý tình hình tài chính của các booking.
        </p>
      </div>
    </div>

    <!--
      Ghi chú:
      - Thêm `overflow-hidden` để đảm bảo bo góc được áp dụng đúng cho bảng bên trong.
    -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
      <!-- Card Header with Search -->
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-4 sm:p-6 border-b border-gray-200">
        <h3 class="text-xl font-semibold text-gray-800">Danh sách Booking</h3>
        <div class="w-full sm:w-auto sm:max-w-xs">
          <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton">
            <input
              type="text"
              nz-input
              placeholder="Tìm kiếm theo tên tour..."
              [(ngModel)]="searchTerm"
              (ngModelChange)="onSearchChange($event)"
            />
          </nz-input-group>
          <ng-template #suffixIconButton>
            <button nz-button nzType="primary" nzSearch>
              <i nz-icon nzType="search"></i>
            </button>
          </ng-template>
        </div>
      </div>

      <!-- Table Wrapper -->
      <div class="overflow-x-auto">
        <nz-table
          #bookingTable
          [nzData]="bookings.items"
          [nzFrontPagination]="false"
          [nzLoading]="isLoading"
          [nzTotal]="bookings.total"
          [nzPageSize]="bookings.size"
          [nzPageIndex]="bookings.page + 1"
          (nzPageIndexChange)="onPageChange($event)"
          [nzShowPagination]="false"
          [nzBordered]="false"
          class="min-w-full"
        >
          <thead>
            <tr class="bg-gray-50">
              <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">STT</th>
              <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Tên Tour</th>
              <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Ngày đi</th>
              <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Ngày về</th>
              <th class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">Trạng thái</th>
              <th class="px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider">Hành động</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of bookingTable.data; let i = index" class="border-b border-gray-200 hover:bg-gray-50">
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ (bookings.page * bookings.size) + i + 1 }}</td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm font-semibold text-gray-900">{{ data.tourName }}</div>
                <div class="text-xs text-gray-500">{{ data.duration }} ngày</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ data.startDate | formatDate }}</td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{{ data.endDate | formatDate }}</td>
              <td class="px-6 py-4 whitespace-nowrap text-center">
                <nz-tag [nzColor]="getStatusColor(data.status)">{{ data.status }}</nz-tag>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                <a (click)="viewSettlementDetail(data.bookingId)" class="text-indigo-600 hover:text-indigo-800 cursor-pointer inline-flex items-center gap-1">
                  <i nz-icon nzType="dollar-circle" nzTheme="outline"></i>
                  <span>Xem quyết toán</span>
                </a>
              </td>
            </tr>
            <!-- Trạng thái không có dữ liệu -->
            <tr *ngIf="!isLoading && bookings.total === 0">
              <td colspan="6" class="text-center py-16">
                <nz-empty nzNotFoundImage="simple" nzNotFoundContent="Không có dữ liệu"></nz-empty>
              </td>
            </tr>
          </tbody>
        </nz-table>
      </div>

      <!-- Pagination -->
      <div *ngIf="bookings.total > bookings.size" class="flex justify-end p-4 sm:p-6">
        <app-pagination
          [currentPage]="bookings.page + 1"
          [totalItems]="bookings.total"
          [pageSize]="bookings.size"
          (pageChange)="onPageChange($event)"
        ></app-pagination>
      </div>
    </div>
  </div>
</div>
