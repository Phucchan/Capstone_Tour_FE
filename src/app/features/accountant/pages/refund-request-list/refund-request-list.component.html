<!-- Ghi chú: Áp dụng layout container căn giữa và nền xám. -->
<div class="bg-gray-50 min-h-screen">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Page Header -->
    <div class="mb-6">
      <h1 class="text-2xl md:text-3xl font-bold text-gray-900">
        Yêu cầu Hoàn tiền
      </h1>
      <p class="text-sm text-gray-600 mt-1">
        Duyệt và xử lý các yêu cầu hoàn tiền từ khách hàng.
      </p>
    </div>

    <!-- Main Content Card -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
      <!-- Card Header with Search -->
      <div
        class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-4 sm:p-6 border-b border-gray-200"
      >
        <h3 class="text-xl font-semibold text-gray-800">Danh sách Yêu cầu</h3>
        <div class="w-full sm:w-auto sm:max-w-xs">
          <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton">
            <input
              type="text"
              nz-input
              placeholder="Tìm theo mã tour, tên KH..."
              [(ngModel)]="searchTerm"
              (ngModelChange)="onSearchChange($event)"
            />
          </nz-input-group>
          <ng-template #suffixIconButton>
            <button nz-button nzType="primary" nzSearch>
              <i nz-icon nzType="search"></i>
            </button>
          </ng-template>
        </div>
      </div>

      <!-- Table Wrapper -->
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th
                scope="col"
                class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Mã Booking
              </th>

              <th
                scope="col"
                class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Thông tin Tour
              </th>
              <th
                scope="col"
                class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Tên Khách Hàng
              </th>
              <th
                scope="col"
                class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Ngày đi
              </th>
              <th
                scope="col"
                class="px-6 py-3 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Trạng thái
              </th>
              <th
                scope="col"
                class="px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider"
              >
                Hành động
              </th>
            </tr>
          </thead>
          <!-- Loading Skeleton -->
          <tbody *ngIf="isLoading">
            <tr *ngFor="let i of [1, 2, 3, 4, 5]">
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
              <td class="px-6 py-4">
                <div class="h-4 bg-gray-200 rounded animate-pulse"></div>
              </td>
            </tr>
          </tbody>
          <!-- Data Body -->
          <tbody *ngIf="!isLoading" class="bg-white divide-y divide-gray-200">
            <tr
              *ngFor="let data of refunds.items"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td
                class="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-700"
              >
                {{ data.bookingCode }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm font-semibold text-gray-900">
                  {{ data.tourCode }}
                </div>
                <div class="text-xs text-gray-500">{{ data.tourName }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                {{ data.customerName }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                {{ data.startDate | formatDate }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-center">
                <nz-tag [nzColor]="getStatusColor(data.status)">{{ data.status | statusVietnamese }}</nz-tag>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <a
                  (click)="viewDetail(data.bookingId)"
                  class="text-indigo-600 hover:text-indigo-800 cursor-pointer inline-flex items-center gap-1 font-semibold"
                >
                  <i nz-icon nzType="eye" nzTheme="outline"></i>
                  <span>Xem chi tiết</span>
                </a>
              </td>
            </tr>
            <!-- Empty State -->
            <tr *ngIf="refunds.total === 0">
              <td colspan="5" class="text-center py-16">
                <nz-empty
                  nzNotFoundImage="simple"
                  nzNotFoundContent="Không có yêu cầu hoàn tiền nào"
                ></nz-empty>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div
        *ngIf="refunds.total > refunds.size"
        class="flex justify-end p-4 sm:p-6 border-t border-gray-200"
      >
        <app-pagination
          [currentPage]="refunds.page + 1"
          [totalItems]="refunds.total"
          [pageSize]="refunds.size"
          (pageChange)="onPageChange($event)"
        ></app-pagination>
      </div>
    </div>
  </div>
</div>
