<!-- src/app/shared/components/admin-sidebar/admin-sidebar-menu/admin-sidebar-menu.component.html -->

<!-- Sử dụng async pipe để hiển thị menu từ Observable đã được lọc theo role -->
<div *ngFor="let menu of menuItems$ | async">
  <!-- Hiển thị tên nhóm menu -->
  <div *ngIf="menu.separator && layoutService.showSideBar" class="pointer-events-none mt-6 px-4 pb-2 text-xs font-semibold uppercase text-gray-500">
    <span>{{ menu.group }}</span>
  </div>

  <!-- Lặp qua các mục con (SubMenuItem) trong mỗi nhóm -->
  <div *ngFor="let item of menu.items">
    <!-- MỤC CÓ MENU CON -->
    <div *ngIf="item.children && item.children.length > 0">
      <div
        class="group flex cursor-pointer items-center justify-between rounded-md px-4 py-2 text-sm hover:bg-gray-100"
        (click)="toggleMenu(item)">
        <div class="flex items-center gap-2">
          <svg-icon [src]="item.icon || ''" [svgClass]="'h-5 w-5 fill-current text-gray-500 group-hover:text-gray-800'"></svg-icon>
          <span *ngIf="layoutService.showSideBar" class="font-medium text-gray-500 group-hover:text-gray-800">
            {{ item.label }}
          </span>
        </div>
        <svg-icon *ngIf="layoutService.showSideBar"
          src="assets/icons/heroicons/solid/chevron-right.svg"
          [ngClass]="{ 'rotate-90': item.expanded }"
          class="h-5 w-5 text-gray-500 transition-transform duration-300"></svg-icon>
      </div>
      <!-- Hiển thị menu con nếu được mở rộng -->
      <div [ngClass]="{ hidden: !item.expanded }" class="ms-4 ps-2 transition-all duration-300">
        <app-admin-sidebar-sub-menu [submenu]="item.children"></app-admin-sidebar-sub-menu>
      </div>
    </div>

    <!-- MỤC KHÔNG CÓ MENU CON -->
    <div *ngIf="!item.children || item.children.length === 0">
      <a [routerLink]="item.route" routerLinkActive="bg-gray-100 text-gray-800 font-bold"
        class="group flex items-center gap-2 rounded-md px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800">
        <svg-icon [src]="item.icon || ''" [svgClass]="'h-5 w-5 fill-current'"></svg-icon>
        <span *ngIf="layoutService.showSideBar">{{ item.label }}</span>
      </a>
    </div>
  </div>
</div>
